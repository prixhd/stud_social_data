<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title th:text="${title}"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" media="all"
          href="../../css/style.css" th:href="@{/css/style.css}" />
</head>
<body>
<header th:insert="~{blocks/header :: header}"></header>

<div class="container mt-5">
    <h1>–°–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h1>

    <!-- –ü–æ–∏—Å–∫ (–≤–µ—Ä–Ω—É–ª–∏ —Å—Ç–∞—Ä—ã–π –¥–∏–∑–∞–π–Ω) -->
    <div class="search-filter input-group mb-3">
        <input type="search" id="searchInputName" class="form-control rounded"
               placeholder="–í–≤–µ–¥–∏—Ç–µ –§–ò–û –∏–ª–∏ –Ω–æ–º–µ—Ä –ø—Ä–∏–∫–∞–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω–æ–≤ –∏–ª–∏ 3189-—Å)"
               aria-label="Search" aria-describedby="search-addon"/>
        <a id="searchLinkName" onclick="validateInput()" class="btn btn-outline-primary">–ü–æ–∏—Å–∫</a>
    </div>

    <form class="filters" id="filterForm" action="/students/show/filter">
        <!-- –ü–ï–†–í–ê–Ø –°–¢–†–û–ö–ê - –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã -->
        <div class="select-filters row g-3 mt-1">

            <div class="faculty-filter col-md-3">
                <select name="faculty" class="form-select mt-2">
                    <option value="" selected disabled hidden>–§–∞–∫—É–ª—å—Ç–µ—Ç</option>
                    <option value="1" th:selected="${appliedFaculty == '1'}">–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π</option>
                    <option value="2" th:selected="${appliedFaculty == '2'}">–í–æ—Å—Ç–æ–∫–æ–≤–µ–¥–µ–Ω–∏—è</option>
                    <option value="3" th:selected="${appliedFaculty == '3'}">–§–∏–∑–∫—É–ª—å—Ç—É—Ä–Ω—ã–π</option>
                    <option value="4" th:selected="${appliedFaculty == '4'}">–°–æ—Ü–∏–∞–ª—å–Ω—ã–π</option>
                    <option value="5" th:selected="${appliedFaculty == '5'}">–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π</option>
                    <option value="6" th:selected="${appliedFaculty == '6'}">–§–ò–Ø</option>
                    <option value="7" th:selected="${appliedFaculty == '7'}">–§–ò–∏–ò–¢</option>
                    <option value="8" th:selected="${appliedFaculty == '8'}">–ö—É–ª—å—Ç—É—Ä—ã</option>
                    <option value="9" th:selected="${appliedFaculty == '9'}">–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π</option>
                    <option value="10" th:selected="${appliedFaculty == '10'}">–ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏ –∏ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏</option>
                    <option value="11" th:selected="${appliedFaculty == '11'}">–§–∏–∑–∏—á–µ—Å–∫–∏–π</option>
                    <option value="12" th:selected="${appliedFaculty == '12'}">–§–∏–ª–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π</option>
                    <option value="13" th:selected="${appliedFaculty == '13'}">–•–∏–º–∏—á–µ—Å–∫–∏–π</option>
                    <option value="14" th:selected="${appliedFaculty == '14'}">–≠–∫–æ–ª–æ–≥–∏–∏</option>
                    <option value="15" th:selected="${appliedFaculty == '15'}">–≠–∫–æ–Ω–æ–º–∏–∫–∏</option>
                    <option value="16" th:selected="${appliedFaculty == '16'}">–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π</option>
                    <option value="17" th:selected="${appliedFaculty == '17'}">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</option>
                    <option value="18" th:selected="${appliedFaculty == '18'}">–ö–æ–ª–ª–µ–¥–∂</option>
                </select>
            </div>

            <div class="scholarship-filter col-md-3">
                <select name="scholarship" class="form-select mt-2">
                    <option value="" selected disabled hidden>–°—Ç–∏–ø–µ–Ω–¥–∏—è</option>
                    <option value="1" th:selected="${appliedScholarship == '1'}">–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç–∏–ø–µ–Ω–¥–∏—è</option>
                    <option value="2" th:selected="${appliedScholarship == '2'}">–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç–∏–ø–µ–Ω–¥–∏—è –≤ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ</option>
                </select>
            </div>

            <div class="studyForm-filter col-md-3">
                <select name="studyForm" class="form-select mt-2">
                    <option value="" selected disabled hidden>–§–æ—Ä–º–∞ –æ–±—É—á–µ–Ω–∏—è</option>
                    <option value="1" th:selected="${appliedStudyForm == '1'}">–ë–∞–∫–∞–ª–∞–≤—Ä–∏–∞—Ç</option>
                    <option value="2" th:selected="${appliedStudyForm == '2'}">–ú–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞</option>
                </select>
            </div>

            <div class="foundation-filter col-md-3">
                <select name="foundation" class="form-select mt-2">
                    <option value="" selected disabled hidden>–û—Å–Ω–æ–≤–∞–Ω–∏–µ</option>
                    <option value="1" th:selected="${appliedFoundation == '1'}">–£–°–ó–ù</option>
                    <option value="2" th:selected="${appliedFoundation == '2'}">–ò–Ω–≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å</option>
                    <option value="3" th:selected="${appliedFoundation == '3'}">–ü–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</option>
                    <option value="4" th:selected="${appliedFoundation == '4'}">–í–µ—Ç–µ—Ä–∞–Ω –±–æ–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π</option>
                </select>
            </div>

            <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫—É—Ä—Å—É -->

        </div>

        <!-- –í–¢–û–†–ê–Ø –°–¢–†–û–ö–ê - —Ñ–∏–ª—å—Ç—Ä—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ä–∞—Å—Ç—è–Ω—É—Ç—ã–µ –ø–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É -->
        <div class="sort-filters row g-3 mt-2">
            <div class="course-filter col-md-4">
                <select name="course" class="form-select mt-2">
                    <option value="" selected disabled hidden>–ö—É—Ä—Å</option>
                    <option value="1" th:selected="${appliedCourse == '1'}">1 –∫—É—Ä—Å</option>
                    <option value="2" th:selected="${appliedCourse == '2'}">2 –∫—É—Ä—Å</option>
                    <option value="3" th:selected="${appliedCourse == '3'}">3 –∫—É—Ä—Å</option>
                    <option value="4" th:selected="${appliedCourse == '4'}">4 –∫—É—Ä—Å</option>
                    <option value="5" th:selected="${appliedCourse == '5'}">5 –∫—É—Ä—Å</option>
                    <option value="6" th:selected="${appliedCourse == '6'}">6 –∫—É—Ä—Å</option>
                </select>
            </div>

            <div class="sortColumn-filter col-md-4">
                <select name="sortColumn" class="form-select mt-2">
                    <option value="" selected disabled hidden>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:</option>
                    <option value="id" th:selected="${appliedSortColumn == 'id'}">ID</option>
                    <option value="firstName" th:selected="${appliedSortColumn == 'firstName'}">–ò–º–µ–Ω–∏</option>
                    <option value="lastName" th:selected="${appliedSortColumn == 'lastName'}">–§–∞–º–∏–ª–∏–∏</option>
                    <option value="course" th:selected="${appliedSortColumn == 'course'}">–ö—É—Ä—Å—É</option>
                    <option value="orderNumber" th:selected="${appliedSortColumn == 'orderNumber'}">–ù–æ–º–µ—Ä—É –ø—Ä–∏–∫–∞–∑–∞</option>
                    <option value="issuanceEndDate" th:selected="${appliedSortColumn == 'issuanceEndDate'}">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—ã–¥–∞—á–∏</option>
                    <option value="foundationEndDate" th:selected="${appliedSortColumn == 'foundationEndDate'}">–û–∫–æ–Ω—á–∞–Ω–∏–µ —Å—Ä–æ–∫–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è</option>
                </select>
            </div>

            <div class="sortDirection-filter col-md-4">
                <select name="sortDirection" class="form-select mt-2">
                    <option value="" selected disabled hidden>–£–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –ø–æ:</option>
                    <option value="asc" th:selected="${appliedSortDirection == 'asc'}">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
                    <option value="desc" th:selected="${appliedSortDirection == 'desc'}">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</option>
                </select>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class="buttons row mb-3 mt-3 justify-content-evenly">
            <button type="submit" class="btn btn-outline-primary col-6 col-md-2 mb-2">
                üîç –ò—Å–∫–∞—Ç—å –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º
            </button>
            <a class="btn btn-outline-primary col-6 col-md-2 mb-2" th:href="@{/students/show/check}">
                ‚è∞ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—ã–¥–∞—á–∏
            </a>
            <a class="btn btn-outline-primary col-6 col-md-2 mb-2" th:href="@{/students/show/check-foundation}">
                üìã –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–æ–∫ –æ—Å–Ω–æ–≤–∞–Ω–∏—è
            </a>
            <a class="btn btn-outline-primary col-6 col-md-2 mb-2" th:href="@{/students/show/week-ending}">
                üìÖ –ù–µ–¥–µ–ª—è –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ä–æ–∫–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è
            </a>
            <a class="btn btn-outline-primary col-6 col-md-2 mb-2" th:href="@{/students/show}">
                üîÑ –°–±—Ä–æ—Å–∏—Ç—å
            </a>
            <button type="button" class="btn btn-outline-primary col-6 col-md-2 mb-2" onclick="showDeleteForm()">
                üóëÔ∏è –í—ã–±—Ä–∞—Ç—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            </button>
            <button type="button" class="btn btn-outline-primary col-6 col-md-2 mb-2" onclick="exportFiltered()">
                üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
            </button>
        </div>
    </form>


    <!-- –¢–∞–±–ª–∏—Ü–∞ –æ–±—ã—á–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ -->
    <div id="normalTable" class="alert alert-primary scrollable-table" style="font-size: 12px; overflow-x: auto">
        <table class='table table-primary table-striped mt-4'>
            <thead>
            <tr>
                <th>ID</th>
                <th>–§–∞–º–∏–ª–∏—è</th>
                <th>–ò–º—è</th>
                <th>–û—Ç—á–µ—Å—Ç–≤–æ</th>
                <th>–ö—É—Ä—Å</th>
                <th>–§–∞–∫—É–ª—å—Ç–µ—Ç</th>
                <th>–§–æ—Ä–º–∞ –æ–±—É—á–µ–Ω–∏—è</th>
                <th>–°—Ç–∏–ø–µ–Ω–¥–∏—è</th>
                <th>–ù–æ–º–µ—Ä –ø—Ä–∏–∫–∞–∑–∞</th>
                <th>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—ã–¥–∞—á–∏</th>
                <th>–û–∫–æ–Ω—á–∞–Ω–∏–µ —Å—Ä–æ–∫–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—è</th>
                <th>–û—Å–Ω–æ–≤–∞–Ω–∏–µ</th>
                <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="el : ${students}" class="student-row" th:data-student-id="${el.id}">
                <td th:text="${el.id}"></td>
                <td th:text="${el.lastName}"></td>
                <td th:text="${el.firstName}"></td>
                <td th:text="${el.middleName}"></td>
                <td th:text="${el.course}"></td>
                <td th:text="${el.faculty?.name}"></td>
                <td th:text="${el.studyForm?.name}"></td>
                <td th:text="${el.scholarship?.name}"></td>
                <td th:text="${el.orderNumber}"></td>
                <td th:text="${el.issuanceEndDate}"></td>
                <td th:text="${el.isPermanent != null && el.isPermanent ? '–ë–µ—Å—Å—Ä–æ—á–Ω–æ' : (el.foundationEndDate != null ? el.foundationEndDate : '')}"></td>
                <td th:text="${el.foundation?.name}"></td>
                <td>
                    <a class="btn btn-warning btn-sm mb-1" th:href="@{/students/edit/{id}(id=${el.id})}">–ò–∑–º–µ–Ω–∏—Ç—å</a>
                    <button type="button" class="btn btn-danger btn-sm deleteButton" th:data-student-id="${el.id}">–£–¥–∞–ª–∏—Ç—å</button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- –§–æ—Ä–º–∞ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è (—Å–∫—Ä—ã—Ç–∞—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div id="deleteForm" style="display: none;">
        <!-- –ö–ù–û–ü–ö–ê –£–î–ê–õ–ï–ù–ò–Ø –ù–ê–í–ï–†–•–£ -->
        <div class="d-flex justify-content-between align-items-center mb-3 p-3 bg-light rounded">
            <h5 class="mb-0">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:</h5>
            <div>
                <button type="button" class="btn btn-danger me-2 deleteManyStudentsButton" data-bs-toggle="modal" data-bs-target="#deleteModal">
                    üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö
                </button>
                <button type="button" class="btn btn-secondary" onclick="hideDeleteForm()">
                    ‚ùå –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>

        <form class="form-checked-students" action="/students/show/deleteStudents" method="post">
            <div class="alert alert-warning scrollable-table" style="font-size: 12px; overflow-x: auto">
                <table class='table table-warning table-striped'>
                    <thead>
                    <tr>
                        <th>–í—ã–±—Ä–∞—Ç—å</th>
                        <th>ID</th>
                        <th>–§–∞–º–∏–ª–∏—è</th>
                        <th>–ò–º—è</th>
                        <th>–û—Ç—á–µ—Å—Ç–≤–æ</th>
                        <th>–ö—É—Ä—Å</th>
                        <th>–§–∞–∫—É–ª—å—Ç–µ—Ç</th>
                        <th>–°—Ç–∏–ø–µ–Ω–¥–∏—è</th>
                        <th>–û—Å–Ω–æ–≤–∞–Ω–∏–µ</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="el, iterStat : ${students}">
                        <td>
                            <input type="checkbox" class="btn-check" th:id="'btn-check-' + ${iterStat.count}"
                                   autocomplete="off" name="selectedStudents" th:value="${el.id}">
                            <label class="btn btn-outline-danger btn-sm" th:for="'btn-check-' + ${iterStat.count}">
                                –í—ã–±—Ä–∞—Ç—å
                            </label>
                        </td>
                        <td th:text="${el.id}"></td>
                        <td th:text="${el.lastName}"></td>
                        <td th:text="${el.firstName}"></td>
                        <td th:text="${el.middleName}"></td>
                        <td th:text="${el.course}"></td>
                        <td th:text="${el.faculty?.name}"></td>
                        <td th:text="${el.scholarship?.name}"></td>
                        <td th:text="${el.foundation?.name}"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </form>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel">–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ù–µ—Ç</button>
                    <form id="confirmDeleteForm" method="post">
                        <button type="submit" class="btn btn-danger">–î–∞, —É–¥–∞–ª–∏—Ç—å</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
        $('.deleteButton').click(function() {
            let studentId = $(this).data('student-id');
            $('#confirmDeleteForm').attr('action', '/students/delete/' + studentId);
            $('#deleteModal').modal('show');
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        $('.deleteManyStudentsButton').click(function() {
            let selectedStudents = [];
            $('input[name="selectedStudents"]:checked').each(function() {
                selectedStudents.push($(this).val());
            });

            if (selectedStudents.length > 0) {
                $('#deleteModal').modal('show');
                $('#confirmDeleteForm').attr('action', '/students/show/deleteStudents');
                $('#confirmDeleteForm').find('input[name="selectedStudents"]').remove();
                selectedStudents.forEach(function(studentId) {
                    $('#confirmDeleteForm').append('<input type="hidden" name="selectedStudents" value="' + studentId + '">');
                });
            } else {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.');
            }
        });
    });

    function validateInput() {
        let input = document.getElementById('searchInputName').value;
        if (input.trim() === '') {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞.');
            return false;
        }
        updateSearchLink();
        window.location.href = "/students/show/search/" + encodeURIComponent(input);
        return true;
    }

    function updateSearchLink() {
        let inputValue = document.getElementById('searchInputName').value;
        let searchLink = document.getElementById('searchLinkName');
        searchLink.setAttribute('href', "/students/show/search/" + encodeURIComponent(inputValue));
    }

    function showDeleteForm() {
        document.getElementById('normalTable').style.display = 'none';
        document.getElementById('deleteForm').style.display = 'block';
    }

    function hideDeleteForm() {
        document.getElementById('normalTable').style.display = 'block';
        document.getElementById('deleteForm').style.display = 'none';
    }

    // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ - —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞–µ—Ç ID –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
    function exportFiltered() {
        console.log('üîÑ –ù–∞—á–∏–Ω–∞–µ–º —ç–∫—Å–ø–æ—Ä—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤...');

        // –°–æ–±–∏—Ä–∞–µ–º ID –≤—Å–µ—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–µ–π—á–∞—Å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ
        let displayedStudentIds = [];
        document.querySelectorAll('.student-row').forEach(function(row) {
            let studentId = row.getAttribute('data-student-id');
            if (studentId) {
                displayedStudentIds.push(studentId);
            }
        });

        console.log('üìã ID –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:', displayedStudentIds);
        console.log('üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞:', displayedStudentIds.length);

        if (displayedStudentIds.length === 0) {
            alert('–ù–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞');
            return;
        }

        // –§–æ—Ä–º–∏—Ä—É–µ–º URL —Å ID —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        let exportUrl = '/students/export-by-ids';

        // –°–æ–∑–¥–∞–µ–º —Ñ–æ—Ä–º—É –¥–ª—è POST –∑–∞–ø—Ä–æ—Å–∞ —Å ID —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        let form = document.createElement('form');
        form.method = 'POST';
        form.action = exportUrl;
        form.style.display = 'none';

        // –î–æ–±–∞–≤–ª—è–µ–º ID —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∫–∞–∫ —Å–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è
        displayedStudentIds.forEach(function(studentId) {
            let input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'studentIds';
            input.value = studentId;
            form.appendChild(input);
        });

        // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
        document.body.appendChild(form);
        form.submit();

        // –£–¥–∞–ª—è–µ–º —Ñ–æ—Ä–º—É –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
        setTimeout(function() {
            document.body.removeChild(form);
        }, 1000);
    }
</script>
</body>
</html>